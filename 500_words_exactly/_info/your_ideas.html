<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE-edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="imagetoolbar" content="no" />
    <!-- Bootstrap local link -->
    <link href="../../_bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="../main.css" rel="stylesheet">
    <!-- Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <link rel="shortcut icon" href="../_story_images/coo.ico">

    <title>500 Words - Your Ideas</title>
</head>

<style>

.form-control {
  font-size: 1.25rem; 
}

</style>


<body>
  <!-- if device is mobile show orientation warning - controlled in main.css-->
  <!-- prevents small screens showing in landscape -->
  <div class="orientation-warning">
    Please rotate your device to portrait mode for the best experience.
  </div>
  <!-- fixes the top title image in place -->
  <div class="fixed-top">
    <div class="header container text-center my-3">
      <h1>
        <a>
          <img src="../_story_images/500_title.png" alt="500_title" class="img-fluid" style="height:5%vh;">
        </a>
      </h1>
    </div>

    <!-- places buttons in one plaace -->
     <!-- these are not standard buttons -->
    <div class="container text-center">
        <div class="button-container">
          <a href="../_info/500_words.html" class="btn btn-secondary mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Learn more about 500 words">About 500 Words</a>
          <a href="../_info/foreward.html" class="btn btn-danger mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="A bit of an intro.">Foreward</a>
          <a href="../_info/acknowledgements.html" class="btn btn-warning mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="These people deserve some thanks.">Acknowledgements</a>
          <a href="../_info/cast1000.html" class="btn btn-primary mx-1 hover-effect-btn">Cast of a Thousand</a>
          <a href="../_info/random_story.html" class="btn btn-success mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Complete pot luck.">Random Story</a>
          <a href="../_info/future_stuff.html" class="btn btn-warning mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Things i'm working on">Future Stories</a>
          <a href="../" class="btn btn-primary mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Return to main page">Return to main page</a>
        </div>
      </div>


    <div class="d-flex align-items-center justify-content-center below-header"> 
        <h1 class="mb-0">500 Words - Be Creative</h1>
    </div>
  </div>
    
  <div class="main-content">
    <div class="scrollable-container">
      <div class="container-special my-1">
        <div style="text-align: left;">
          <!-- Main content section -->
          <main class="content" style="padding-bottom: 10px; " id="content">
            <!-- Content loaded via JavaScript will appear here -->
          </main>
          <button id="toggleButton" class="btn btn-primary mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Write your story">I'm ready to write my story.</button>

          <!-- Story form (hidden by default) -->
          <div class="container mt-0" id="story_form" style="display: none;">
            <form id="storyForm">
              <!-- Use Bootstrap row class for layout -->
              <div class="row">
                <div class="form-group col-md-6">
                  <h5><label for="name">My name is:</label></h5>
                  <input type="text" class="form-control" id="name" name="name" placeholder="Mickey Mouse">
                </div>
                <div class="form-group col-md-6">
                  <h5><label for="age">My age is:</label></h5>
                  <input type="number" class="form-control" id="age" name="age" placeholder="103">
                </div>
              </div>
              <div class="form-group mt-3">
                <h5><label for="title">My story is called:</label></h5>
                <input type="title" class="form-control" id="title" name="name" placeholder="The name of my story is...">
              </div> 
              <div class="row">
                <div class="form-group col-md-9">
                  <h5><label for="idea">And this is my story:</label></h5>
                  <textarea id="idea" class="form-control" name="idea" placeholder="I have an idea and it starts like this..."></textarea>
                </div>    
                <div class="form-group col-md-3 d-flex align-items-center">
                  <div class="form-check">
                    <input type="radio" class="form-check-input" id="i_do" name="who_do" value="This is ready to go.">
                    <label class="form-check-label" for="i_do">I have written it</label>
                  </div>
                  <div class="form-check">
                    <input type="radio" class="form-check-input" id="you_do" name="who_do" value="I would like you to write it please.">
                    <label class="form-check-label" for="you_do">I want you to write it please.</label>
                  </div>
                </div>
              </div>
              <button type="submit" class="btn btn-primary mt-3">Save It! & Send It!</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
    
    <br>
    <div class="footer d-flex align-items-center justify-content-evenly">
        <a href="https://www.bbc.co.uk/teach/500-words">500 words - BBC</a>
        <a href="https://www.storycubes.com/en/">Rory's story cubes</a>
        <a href="sitemap.html">Site Map</a>
      </div>
      <br>
    <script>
      // When the document is loaded, fetch the text file and update the content
      document.addEventListener("DOMContentLoaded", function() {
        fetch("your_ideas.txt")
          .then(response => response.text())
          .then(data => {
              // Convert newline characters to <br> tags
              const contentWithBreaks = data.replace(/\n/g, "<br>");
              document.getElementById("content").innerHTML = contentWithBreaks;
          })
          .catch(error => {
              console.error("Error fetching the file:", error);
              document.getElementById("content").innerHTML = "Failed to load content.";
          });
      });
    
      // Form submission handling
      document.getElementById('storyForm').addEventListener('submit', function(e) {
        e.preventDefault();
    
        // Get the form values
        const name = document.getElementById('name').value;
        const age = document.getElementById('age').value;
        const title = document.getElementById('title').value;
        const idea = document.getElementById('idea').value;
        const whoDoEl = document.querySelector('input[name="who_do"]:checked'); // this needs to be handled differently because it is a choice 
        const who_do = whoDoEl ? whoDoEl.value : '';
    
        // Create the text content for the file and email
        const content = `Name: ${name}\nAge: ${age}\nStory Title: ${title}\n\nStory:\n${idea}\n\nWho is writing it?: ${who_do}`;
    
        // Create a Blob for the file download
        const blob = new Blob([content], { type: 'text/plain' });
        const downloadLink = document.createElement('a');
        downloadLink.href = URL.createObjectURL(blob);
        // Use the story title as file name, trim and replace spaces
        downloadLink.download = title.trim().replace(/\s+/g, '_') + '.txt';
        downloadLink.click();  // start the download
    
        // Construct the mailto link with the content as the body
        const recipient = "bassjuggler@gmail.com";
        const subject = title; 
        const body = encodeURIComponent(content);
    
        // Create the mailto URL and open the mail program
        const mailtoLink = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${body}`;
        window.location.href = mailtoLink;
    
        // Optionally, revoke the object URL after a delay to free memory
        setTimeout(() => {
          URL.revokeObjectURL(downloadLink.href);
        }, 100);
      });
    
      // Toggle between content and form display
      document.getElementById('toggleButton').addEventListener('click', function() {
        const mainContent = document.getElementById('content');
        const form = document.getElementById('story_form');
        const button = document.getElementById('toggleButton');
    
        // Toggle display: if form is hidden, show it and hide content; else, reverse.
        if (window.getComputedStyle(mainContent).display !== 'none') {
          mainContent.style.display = 'none';
          button.style.display = 'none';
          form.style.display = 'block';
        } else {
          mainContent.style.display = 'block';
          button.style.display = 'block';
          form.style.display = 'none';
        }
      });
    </script>
</body>
</html>
